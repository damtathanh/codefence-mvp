import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { useState } from 'react';
import { PageLayout } from '../../components/layout/PageLayout';
import { useDashboardStats } from '../../features/dashboard/useDashboardStats';
import { DateRangeSelector } from '../../components/dashboard/DateRangeSelector';
import { OrdersStatusChart } from '../../features/dashboard/components/OrdersStatusChart';
import { RevenueChart } from '../../features/dashboard/components/RevenueChart';
import { RiskDistributionChart } from '../../features/dashboard/components/RiskDistributionChart';
import { HighRiskOrdersCard } from '../../features/dashboard/components/HighRiskOrdersCard';
import { Package, DollarSign, Clock, CheckCircle, TrendingUp, XCircle } from 'lucide-react';
const formatCurrency = (value) => {
    return new Intl.NumberFormat('vi-VN', {
        style: 'currency',
        currency: 'VND',
        maximumFractionDigits: 0,
    }).format(value);
};
const formatPercent = (value) => {
    return `${value.toFixed(1)}%`;
};
export const DashboardPage = () => {
    const [dateRange, setDateRange] = useState('last_month');
    const [customFrom, setCustomFrom] = useState('');
    const [customTo, setCustomTo] = useState('');
    const { loading, error, stats, ordersChart, revenueChart, riskDistribution, highRiskOrders } = useDashboardStats(dateRange, customFrom || undefined, customTo || undefined);
    return (_jsxs(PageLayout, { children: [_jsx("div", { className: "mb-6 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between", children: _jsx(DateRangeSelector, { value: dateRange, onChange: setDateRange, customFrom: customFrom, customTo: customTo, onChangeCustomFrom: setCustomFrom, onChangeCustomTo: setCustomTo }) }), error && (_jsx("div", { className: "p-4 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-center mb-6", children: error })), loading ? (_jsx("div", { className: "space-y-6", children: _jsx("div", { className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6", children: [1, 2, 3, 4, 5, 6].map((i) => (_jsx("div", { className: "h-32 bg-white/5 rounded-xl animate-pulse border border-white/5" }, i))) }) })) : (_jsxs("div", { className: "space-y-6", children: [_jsxs("div", { className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6", children: [_jsx("div", { className: "rounded-2xl bg-[#0B1120] p-5 border border-white/5 shadow-sm", children: _jsxs("div", { className: "flex items-start justify-between", children: [_jsxs("div", { children: [_jsx("h3", { className: "text-sm font-medium text-white/70", children: "Total Orders" }), _jsx("p", { className: "text-3xl font-semibold text-[#8B5CF6] mt-1", children: stats.totalOrders }), _jsxs("p", { className: "text-xs text-white/50 mt-1", children: ["COD: ", stats.codOrders, " | Prepaid: ", stats.prepaidOrders] })] }), _jsx("div", { className: "flex-shrink-0 rounded-xl bg-white/5 p-3", children: _jsx(Package, { className: "w-5 h-5 text-[#8B5CF6]" }) })] }) }), _jsx("div", { className: "rounded-2xl bg-[#0B1120] p-5 border border-white/5 shadow-sm", children: _jsxs("div", { className: "flex items-start justify-between", children: [_jsxs("div", { children: [_jsx("h3", { className: "text-sm font-medium text-white/70", children: "Total Revenue" }), _jsx("p", { className: "text-3xl font-semibold text-green-400 mt-1", children: formatCurrency(stats.totalRevenue) }), _jsxs("p", { className: "text-xs text-white/50 mt-1", children: ["Avg: ", formatCurrency(stats.avgOrderValue)] })] }), _jsx("div", { className: "flex-shrink-0 rounded-xl bg-white/5 p-3", children: _jsx(DollarSign, { className: "w-5 h-5 text-green-400" }) })] }) }), _jsx("div", { className: "rounded-2xl bg-[#0B1120] p-5 border border-white/5 shadow-sm", children: _jsxs("div", { className: "flex items-start justify-between", children: [_jsxs("div", { children: [_jsx("h3", { className: "text-sm font-medium text-white/70", children: "Pending Verification" }), _jsx("p", { className: "text-3xl font-semibold text-yellow-400 mt-1", children: stats.pendingVerification }), _jsx("p", { className: "text-xs text-white/50 mt-1", children: "Orders waiting to be processed" })] }), _jsx("div", { className: "flex-shrink-0 rounded-xl bg-white/5 p-3", children: _jsx(Clock, { className: "w-5 h-5 text-yellow-400" }) })] }) }), _jsx("div", { className: "rounded-2xl bg-[#0B1120] p-5 border border-white/5 shadow-sm", children: _jsxs("div", { className: "flex items-start justify-between", children: [_jsxs("div", { children: [_jsx("h3", { className: "text-sm font-medium text-white/70", children: "Verified Orders (COD)" }), _jsx("p", { className: "text-3xl font-semibold text-blue-400 mt-1", children: stats.verifiedOutcomeCount }), _jsxs("p", { className: "text-xs text-white/50 mt-1", children: ["Verified rate: ", formatPercent(stats.verifiedOutcomeRate)] })] }), _jsx("div", { className: "flex-shrink-0 rounded-xl bg-white/5 p-3", children: _jsx(CheckCircle, { className: "w-5 h-5 text-blue-400" }) })] }) }), _jsx("div", { className: "rounded-2xl bg-[#0B1120] p-5 border border-white/5 shadow-sm", children: _jsxs("div", { className: "flex items-start justify-between", children: [_jsxs("div", { children: [_jsx("h3", { className: "text-sm font-medium text-white/70", children: "Converted Revenue (COD \u2192 Paid)" }), _jsx("p", { className: "text-3xl font-semibold text-emerald-400 mt-1", children: formatCurrency(stats.convertedRevenue) }), _jsxs("p", { className: "text-xs text-white/50 mt-1", children: ["Converted COD: ", stats.convertedOrders, " (", formatPercent(stats.convertedRate), ")"] })] }), _jsx("div", { className: "flex-shrink-0 rounded-xl bg-white/5 p-3", children: _jsx(TrendingUp, { className: "w-5 h-5 text-emerald-400" }) })] }) }), _jsx("div", { className: "rounded-2xl bg-[#0B1120] p-5 border border-white/5 shadow-sm", children: _jsxs("div", { className: "flex items-start justify-between", children: [_jsxs("div", { children: [_jsx("h3", { className: "text-sm font-medium text-white/70", children: "Cancelled Rate (COD)" }), _jsx("p", { className: "text-3xl font-semibold text-red-400 mt-1", children: formatPercent(stats.cancelRate) }), _jsxs("p", { className: "text-xs text-white/50 mt-1", children: ["Cancelled COD: ", stats.codCancelled, " / ", stats.verifiedOutcomeCount] })] }), _jsx("div", { className: "flex-shrink-0 rounded-xl bg-white/5 p-3", children: _jsx(XCircle, { className: "w-5 h-5 text-red-400" }) })] }) })] }), _jsxs("div", { className: "space-y-6", children: [_jsx(OrdersStatusChart, { data: ordersChart }), _jsxs("div", { className: "grid grid-cols-1 lg:grid-cols-3 gap-6", children: [_jsx("div", { className: "lg:col-span-2", children: _jsx(RevenueChart, { data: revenueChart }) }), _jsxs("div", { className: "space-y-6", children: [_jsx(RiskDistributionChart, { data: riskDistribution }), _jsx(HighRiskOrdersCard, { orders: highRiskOrders })] })] })] })] }))] }));
};
